<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <title>たまスコープ 小惑星沢山</title>
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="icon" href="img/favicon.svg" type="image/icon">
    <link rel="apple-touch-icon" href="img/favicon.png" sizes="128x128">
    <link rel="stylesheet" href="css/horo2.css?ver=2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="js/util/SettingUtil.js?ver=2"></script>
    <script src="../common/SettingUtilCommon.js?ver=2"></script>
    <script src="../common/SvgBuilder.js?ver=1.0.1"></script>
    <script src="../common/AspectCalculator.js?ver=3"></script>
    <script src="../common/HouseCalcurator.js"></script>
    <script src="../common/CalcAstroBase.js?ver=1.0.1"></script>
    <script src="../common/SabianUtil.js"></script>
    <script script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1/i18n/jquery.ui.datepicker-ja.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery.loadingoverlay/latest/loadingoverlay.min.js"></script>
    <script type="module" src="../common/CommonUtil.js?ver=3"></script>
</head>

<body>
    <article class="wrapper">
        <main class="main">
            <header>
                <h1>小惑星沢山ホロスコープ</h1>
                <a href="../horo_index.html">戻る</a>
            </header>
            <!-- パラメータ設定-->
            <section id="params" class="params">
                <h2>設定
                    <button class="btn_setting" id="btn_hide" onclick="switchSettingOpen()">隠す</button> 
                    <button class="btn_setting" id="btn_remove_setting">設定を初期化</button></h2>
                <div>
                    <h3>お名前</h3>
                    <input id="name" autocomplete="off">
                </div>
                <div id="setting">
                    <div class="birth-datetime">
                        <h3>誕生日時</h3>
                        <input id="birth-date" placeholder="誕生日" readonly>
                        <select id="birth-hour"></select>:
                        <select id="birth-min"></select><br>
                        <button onclick="setNow()">現在日時</button>
                    </div>
                    <div class="birth-place">
                        <h3>誕生地</h3>
                        <h4>緯度（北緯）</h4>
                        <input type="number" inputmode="numeric" id="latitude-deg" class="deg" min="-180" max="180">°<input
                            type="number" inputmode="numeric" id="latitude-min" class="min" min="0" max="59">′
                        <h4>経度（東経）</h4>
                        <input type="number" inputmode="numeric" id="longitude-deg" class="deg" min="-180" max="180">°<input
                            type="number" inputmode="numeric" id="longitude-min" class="min" min="0" max="59">′
                        <h4>都道府県から選ぶ</h4>
                        <select id="prefecture"></select>
                    </div>
                    <div class="time-diff">
                        <h4>時差</h4>
                        <select id="time-diff"></select>
                    </div>
                    <div>
                        <a href="bodysetting.html">天体設定</a><br>
                        <a href="aspectsetting.html">オーブ設定</a>
                    </div>
                    <div class="buttons">
                        <button id="btn_calc">計算</button>
                    </div>
                </div>
                <div id="house-data" class="house-data">
                    <h3>ハウス</h3>
                    <ul id="house-list"></ul>
                </div>
            </section>
            <section id="result" class="result">
                <h2>計算結果</h2>
                <div class="draw-setting">
                    <div class="house-system">
                        <h4>ハウスシステム</h4>
                        <select id="house-system" onchange="redraw()">
                            <option value="placidus" selected>プラシーダス</option>
                            <option value="campanus">キャンパナス</option>
                            <option value="regiomontanus">レジオモンタナス</option>
                            <option value="solar">ソーラー</option>
                            <option value="solar-sign">ソーラーサイン</option>
                            <option value="koch">コッホ</option>
                        </select>
                    </div>
                    <div class="aspect-setting">
                        <h4>アスペクトの表示</h4>
                        <div class="aspect-display">
                            <div>
                                <label><input id="disp-hard" type="checkbox" onclick="redraw()">ハード</label><br>
                                <label><input id="disp-soft" type="checkbox" onclick="redraw()">ソフト</label><br>
                            </div>
                            <div>
                                <label><input id="disp-tight" type="checkbox" onclick="redraw()" checked>タイト</label><br>
                                <label><input id="disp-loose" type="checkbox" onclick="redraw()" checked>ルーズ</label><br>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h4>天体にオンマウス</h4>
                        <label><input id="display-bodydata" type="checkbox">天体情報表示</label><br>
                        <label><input id="display-aspect" type="checkbox">アスペクト表示</label>
                    </div>
                </div>
                <div id="horoscope" class="horoscope-area"></div>
                <div id="magnify">
                    <button id="plus" class="btn_magnify">＋</button>
                    <button id="minus" class="btn_magnify" disabled>－</button>
                </div>
            </section>
        </main>
        <div id="body-data" class="body-data">
            <h3>天体</h3>
            <div id="body-data-wrapper" class="body-data-wrapper">
                <table id="body-table"></table>
            </div>
        </div>
        <div class="aspect-table">
            <h3>アスペクト</h3>
            <div id="aspect-table"></div>
        </div>
        <div class="body-class">
            <h3>天体区分</h3>
            <div>
                <h4>四区分</h4>
                <div id="div4"></div>
            </div>
            <div>
                <h4>三区分</h4>
                <div id="div3"></div>
            </div>
            <div>
                <h4>二区分</h4>
                <div id="div2"></div>
            </div>
            
            <button class="btn_share" onclick="test()">Share</button>
            <div id="test"></div>
            <script>
                async function test() {
                    let svg = document.getElementById("horoscope").children[0];
                    let casps = document.getElementById("house-list");
                    let bodies = document.getElementById("body-data-wrapper");
                    let aspects = document.getElementById("aspect-table");
                    if(svg && casps && bodies && aspects) {
                        let files = [];
                        files.push(new File([await CommonUtil.Svg2Blob(svg)], "image.png", {type: "image/png"}));
                        files.push(new File([await CommonUtil.Element2Blob(casps)], "image.png", {type: "image/png"}));
                        files.push(new File([await CommonUtil.Element2Blob(bodies)], "image.png", {type: "image/png"}));
                        files.push(new File([await CommonUtil.Element2Blob(aspects)], "image.png", {type: "image/png"}));
                        CommonUtil.Share("小惑星沢山ホロスコープ\n\n#たまスコープ\n#ホロスコープ\n" + "https://tamakki.github.io/website/horo_index.html", "https://tamakki.github.io/website/horo_index.html", files);
                    }
                }
            </script>
            <script src="../common/dom-to-image.js" async></script>
        </div>
        <footer>
            <!-- admax -->
            <script src="https://adm.shinobi.jp/s/5c8d51baf2d24a2ee2195cb917fec71e"></script>
            <!-- admax -->
        </footer>
        <div id="description"></div>
        <div id="aspect-data"></div>
    </article>
    <script src="./js/horo2.js?ver=4"></script>
</body>

</html>